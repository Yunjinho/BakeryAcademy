<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.example.myapp.product.dao.IProductRepository">

	<select id="getProductListByCategory" parameterType="hashmap" resultType="com.example.myapp.product.model.Product">
<![CDATA[
	SELECT
		product_id as "productId",
		product_name as "productName",
		product_price as "productPrice",
		product_content as "productContent",
		product_stock as "productStock"
	FROM
		(
		SELECT
			product_id,
			product_name,
			product_price,
			product_content,
			product_stock,
			ROWNUM as rnum
		FROM
		(
			SELECT
				product_id,
				product_name,
				product_price,
				product_content,
				product_stock
			FROM
				product
			WHERE
				category_id=#{categoryId}
			ORDER BY
				product_id DESC
		)
		)
	WHERE
		rnum BETWEEN #{start} AND #{end}
]]>
	</select>

<select id="selectTotalProductCountByCategoryId" parameterType="int" resultType="int">
	<![CDATA[
		SELECT
			COUNT(category_id)
		FROM
			product
		WHERE
			category_id=#{categoryId}
	]]>
</select>



<select id="getProductImageMinId" parameterType="int" resultType="com.example.myapp.product.model.ProductImage">
	<![CDATA[
	SELECT
		product_image_id	as productImageId,
		product_Id			as productId,
		product_image		as productImage,
		product_image_name	as productImageName,
		product_image_size	as productImageSize,
		product_image_type	as productImageType
	FROM
		product_image
	WHERE
		product_id=#{productId} AND
		product_image_id = (
			SELECT MIN(product_image_id)
			FROM product_image
			WHERE product_id = #{productId}
		)
	]]>
</select>

<select id="getProductImageList" parameterType="int" resultType="com.example.myapp.product.model.ProductImage">
	<![CDATA[
		SELECT * FROM product_image where product_id=#{productId};
	]]>
</select>


</mapper>